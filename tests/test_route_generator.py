# test_route_generator.py

from route_generator import create_cable_routes

postes = [
    {
        'name': 'Poste 1',
        'coordinates': '-39.45170171578749,-4.051798564221868,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 2',
        'coordinates': '-39.45041824186209,-4.051802355041452,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 3',
        'coordinates': '-39.45167937274898,-4.052405604432771,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 4',
        'coordinates': '-39.45014857544662,-4.052420669624774,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 5',
        'coordinates': '-39.45063404928503,-4.051312748851081,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 6',
        'coordinates': '-39.45144385107923,-4.053001161209534,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 7',
        'coordinates': '-39.45084136905412,-4.052739216034889,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 8',
        'coordinates': '-39.45098763992067,-4.052059624520663,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 9',
        'coordinates': '-39.45120344431534,-4.051561062014795,0',
        'type': 'poste',
    },
    {
        'name': 'Poste 10',
        'coordinates': '-39.45120096393784,-4.051562463886588,0',
        'type': 'poste',
    },
]

caixas = [
    {
        'name': 'cx1',
        'coordinates': '-39.45061121049186,-4.051317243901951,0',
        'type': 'nap',
        'poste': 'Poste 5',
    },
    {
        'name': 'cx2',
        'coordinates': '-39.45170580097942,-4.051775984081074,0',
        'type': 'nap',
        'poste': 'Poste 1',
    },
    {
        'name': 'cx3',
        'coordinates': '-39.45036797960606,-4.051774176984686,0',
        'type': 'nap',
        'poste': 'Poste 2',
    },
    {
        'name': 'cx4',
        'coordinates': '-39.45015722936202,-4.052364217337001,0',
        'type': 'nap',
        'poste': 'Poste 4',
    },
]

cabos = [
    {
        'name': 'cb1',
        'coordinates': '-39.45169993993189,-4.051800915159464,0 '
                       '-39.45120096393784,-4.051562463886588,0 '
                       '-39.45061016708521,-4.051318454907148,0 '
                       '-39.45041919276834,-4.051802427580964,0 '
                       '-39.45098708986388,-4.052059906123818,0 '
                       '-39.45168015839144,-4.052402863275873,0',
        'type': 'ramal',
    },
    {
        'name': 'cb2',
        'coordinates': '-39.45144497259615,-4.053004280928643,0 '
                       '-39.45084289108193,-4.052743926550285,0 '
                       '-39.45014797324762,-4.052423340255205,0',
        'type': 'ramal',
    },
    {'name': 'cb3',
     'coordinates': '-39.45184574554322,-4.053183230925058,0 '
                    '-39.45144665178143,-4.053003869122191,0 '
                    '-39.45167478649719,-4.052401195058424,0',
     'type': 'bkb'},
]

ceos = [
    {
        'name': 'cx5',
        'coordinates': '-39.45165552611553,-4.052428230360745,0',
        'type': 'ceo',
        'poste': 'Poste 3',
    },
]

hubs = [
    {
        'name': 'cx6',
        'coordinates': '-39.45146589638154,-4.053010237355891,0',
        'type': 'ceo',
        'poste': 'Poste 6',
    },
]


def test_create_cable_routes():
    pop = {
        'name': 'POP 1',
        'coordinates': '-39.451846,-4.053180,0',
        'poste': 'Poste 10',
    }

    expected_routes = [
        {
            'start': 'POP 1',
            'end': 'CX1',
            'router': ['POP 1', 'cx6', 'cx5', 'Poste 8', 'cx3', 'cx1'],
            'cable': ['Cabo 3', 'Cabo 1'],
            'coordinates': [
                '-39.451846,-4.053180,0',
                '-39.45144385107923,-4.053001161209534,0',
                '-39.45167937274898,-4.052405604432771,0',
                '-39.45098763992067,-4.052059624520663,0',
                '-39.45041824186209,-4.051802355041452,0',
                '-39.45063404928503,-4.051312748851081,0',
            ],
        },
        {
            'start': 'POP 1',
            'end': 'CX2',
            'router': ['POP 1', 'cx6', 'cx5', 'Poste 8', 'cx3', 'cx1', 'Poste 9', 'cx2'],
            'cable': ['Cabo 3', 'Cabo 1'],
            'coordinates': [
                '-39.451846,-4.053180,0',
                '-39.45144385107923,-4.053001161209534,0',
                '-39.45167937274898,-4.052405604432771,0',
                '-39.45098763992067,-4.052059624520663,0',
                '-39.45041824186209,-4.051802355041452,0',
                '-39.45063404928503,-4.051312748851081,0',
                '-39.45120344431534,-4.051561062014795,0',
                '-39.45170171578749,-4.051798564221868,0'
            ],
        },
        {
            'start': 'POP 1',
            'end': 'CX3',
            'router': ['POP 1', 'cx6', 'cx5', 'Poste 8', 'cx3', 'cx1'],
            'cable': ['Cabo 3', 'Cabo 1'],
            'coordinates': [
                '-39.451846,-4.053180,0',
                '-39.45144385107923,-4.053001161209534,0',
                '-39.45167937274898,-4.052405604432771,0',
                '-39.45098763992067,-4.052059624520663,0',
                '-39.45041824186209,-4.051802355041452,0',
            ],
        },
        {
            'start': 'POP 1',
            'end': 'CX4',
            'router': ['POP 1', 'cx6', 'Poste 7', 'cx4'],
            'cable': ['Cabo 3', 'Cabo 2'],
            'coordinates': [
                '-39.451846,-4.053180,0',
                '-39.45144385107923,-4.053001161209534,0',
                '-39.45084136905412,-4.052739216034889,0',
                '-39.45041824186209,-4.051802355041452,0',
            ],
        },
        {
            'start': 'POP 1',
            'end': 'CX5',
            'router': ['POP 1', 'cx6', 'cx5'],
            'cable': ['Cabo 3'],
            'coordinates': [
                '-39.451846,-4.053180,0',
                '-39.45144385107923,-4.053001161209534,0',
                '-39.45167937274898,-4.052405604432771,0',
            ],
        },
    ]
    assert (
            create_cable_routes(pop, caixas+hubs+ceos, cabos) == expected_routes
    )

